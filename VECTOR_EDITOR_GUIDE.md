# 向量编辑器使用指南

## 概述

向量编辑器允许你直接编辑32维几何向量的各个维度参数，进行向量运算，然后通过Decode操作将修改后的向量还原为Blender场景中的3D对象，实时看到渲染效果的变化。

## 功能特性

### 1. 向量加载
- **从预设加载**: 将预定义的几何预设（如螺旋走廊、DNA双螺旋、战斗机等）编码为32维向量
- **从对象加载**: 将当前激活的Blender网格对象编码为32维向量

### 2. 向量编辑
32维向量被组织为以下几个功能组：

#### 形状与拓扑 [0-7]
- `[0]` - Shape Type: 形状类型编码
- `[1]` - Complexity: 几何复杂度
- `[2-4]` - Scale XYZ: 全局缩放
- `[5]` - Symmetry: 对称性度量
- `[6]` - Curvature: 整体曲率
- `[7]` - Topology Genus: 拓扑亏格（孔洞数）

#### 纵横比与变形 [8-14]
- `[8-10]` - Aspect Ratios: XY, XZ, YZ比例
- `[11]` - Elongation: 拉伸因子
- `[12]` - Twist: 扭曲量
- `[13]` - Taper: 锥度因子
- `[14]` - Bend: 弯曲

#### 波形与噪声 [15-18]
- `[15]` - Wave Frequency: 波形频率
- `[16]` - Wave Amplitude: 波形幅度
- `[17]` - Noise Scale: 噪声缩放
- `[18]` - Noise Strength: 噪声强度

#### 形状变形 [19-21]
- `[19]` - Sphericity: 球形度
- `[20]` - Cubicity: 立方体度
- `[21]` - Cylindricity: 圆柱度

#### 保留维度 [22-31]
- 为未来扩展保留的维度

### 3. 向量操作
- **Copy (复制)**: 将当前向量复制到剪贴板
- **Paste (粘贴)**: 从剪贴板粘贴向量到当前
- **Reset (重置)**: 将向量重置为零向量
- **Normalize (归一化)**: 将向量归一化为单位长度

### 4. 向量运算
支持以下数学运算：

#### Add (+) 加法
```
result = current + clipboard
```
将剪贴板向量加到当前向量

#### Subtract (-) 减法
```
result = current - clipboard
```
从当前向量减去剪贴板向量

#### Multiply (*) 乘法
```
result = current * scalar
```
将当前向量乘以标量值

#### Divide (/) 除法
```
result = current / scalar
```
将当前向量除以标量值

#### Interpolate (插值)
```
result = (1-t) * current + t * clipboard
```
在当前向量和剪贴板向量之间线性插值，t ∈ [0, 1]

### 5. Decode & Render (解码并渲染)
将修改后的32维向量解码为Blender场景参数，并立即更新或创建3D对象：
- 自动识别最接近的预设类型
- 将向量参数映射到场景属性
- 触发几何体渲染更新
- 在视口中实时显示结果

## 使用流程示例

### 示例 1: 创建混合几何体

1. **加载第一个向量**
   - 点击 `Load from Preset` → 选择 `Spiral Corridor`
   - 当前向量现在包含螺旋走廊的编码

2. **保存到剪贴板**
   - 点击 `Copy` 按钮

3. **加载第二个向量**
   - 点击 `Load from Preset` → 选择 `DNA Helix`

4. **执行插值运算**
   - 选择运算类型: `Interpolate`
   - 设置 Blend Factor: `0.5` (50%混合)
   - 点击 `Apply Operation`

5. **渲染结果**
   - 点击 `Decode & Render`
   - 观察场景中生成的混合几何体

### 示例 2: 手动调整向量参数

1. **加载基础向量**
   - 点击 `Load from Preset` → 选择任意预设

2. **展开向量编辑器**
   - 点击 "Vector Editor" 左侧的箭头图标展开

3. **编辑特定维度**
   - 修改 `[2-4]` (Scale XYZ) 改变尺寸
   - 修改 `[12]` (Twist) 增加扭曲效果
   - 修改 `[19-21]` 调整形状变形

4. **实时预览**
   - 点击 `Decode & Render`
   - 观察修改的效果

5. **迭代优化**
   - 继续调整参数
   - 每次修改后点击 `Decode & Render` 查看效果

### 示例 3: 向量加法创造新形状

1. **设置基础向量**
   - 加载 `Twisted Tower`
   - 点击 `Copy`

2. **设置偏移向量**
   - 加载 `Spring`
   - 选择运算: `Add`
   - 点击 `Apply Operation`

3. **缩放调整**
   - 选择运算: `Multiply`
   - 设置 Scalar: `0.8`
   - 点击 `Apply Operation`

4. **生成结果**
   - 点击 `Decode & Render`

## 工作原理

### 编码过程
```
3D Geometry → 分析特征 → 32维向量
```
- 提取几何属性（尺寸、比例、曲率等）
- 分析修改器（扭曲、锥度、波形等）
- 归一化为标准向量空间

### 向量空间操作
```
向量A + 向量B = 混合几何特征
```
- 在潜在空间中进行数学运算
- 保持几何意义的连续性
- 支持任意向量组合

### 解码过程
```
32维向量 → 场景参数 → 3D渲染
```
- 将向量维度映射回场景属性
- 设置变形修改器参数
- 触发Blender几何更新

## 技术细节

### 向量空间
- **维度**: 32D欧几里得空间
- **距离度量**: L2范数（欧几里得距离）
- **插值**: 线性插值（LERP）
- **运算**: 标准向量代数

### 数据范围
- 大多数参数范围: `[-1, 1]` 或 `[0, 1]`
- Scale参数: `[0.001, ∞)`
- 角度参数: `[-π, π]`

### 优化建议
1. **归一化**: 在混合不同尺度的向量前先归一化
2. **小步调整**: 手动编辑时使用小增量
3. **保存副本**: 在剪贴板保存备份以便撤销
4. **渐进调整**: 使用插值的方式渐进过渡

## 快捷工作流

### 快速变形
```
Load A → Copy → Load B → Interpolate (0.5) → Decode
```

### 叠加效果
```
Load Base → Copy → Load Effect → Add → Decode
```

### 比例缩放
```
Load → Multiply (scalar) → Decode
```

### 探索空间
```
Load → Manual Edit [0-31] → Decode → Iterate
```

## 注意事项

1. **向量范围**: 某些极端值可能导致不稳定的几何体
2. **组合兼容性**: 不是所有预设的组合都会产生合理结果
3. **性能**: 复杂几何体的解码和渲染可能需要一些时间
4. **备份**: 在大量修改前保存场景文件

## 高级应用

### 1. 形状插值动画
通过改变插值因子t从0到1，创建从形状A到形状B的平滑变形动画。

### 2. 向量空间探索
在已知向量周围随机采样，发现新的有趣几何形状。

### 3. 特征提取
从现有对象中提取向量，分析其数学表示。

### 4. 批量生成
通过系统化的向量操作，批量生成变体几何体。

## 故障排除

### 问题: Decode后没有显示对象
- **解决**: 确保已选择或创建基础几何体
- **检查**: 向量值是否在合理范围内

### 问题: 几何体看起来异常
- **解决**: 尝试降低某些变形参数的值
- **检查**: Scale参数是否过小或过大

### 问题: 运算结果不符合预期
- **解决**: 先归一化向量，再进行运算
- **检查**: 确认剪贴板中的向量是否正确

---

## 参考

相关文档:
- `GEOMETRY_VECTORS_GUIDE.md` - 系统技术文档
- `README_GEOMETRY_VECTORS.md` - 快速入门指南
- `demo_geometry_vectors.py` - 演示脚本

版本: 1.0
更新: 2026-02-08
